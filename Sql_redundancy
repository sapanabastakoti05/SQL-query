---Check existing tables:
SHOW TABLES;

---Select data from  the existing table:
SELECT * FROM Redundancy;

---create temporary table & copy from it :
#### Copy data from redundancy to a new temporary table named Redundancy_st

CREATE Temporary TABLE Redundancy_st
LIKE Redundancy;

---verify temporary table
SHOW TABLES;
---select data from Redundancy_st
SELECT * FROM Redundancy_st;

---insert data into redundancy_st
INSERT Redundancy_st
SELECT * FROM Redundancy;

--- Remove Duplicates using Distinct:
SELECT DISTINCT Organization, Spot, field, total_laid_off, percentage_laid_off, date, stage, country 
FROM Redundancy_st;

-- select the organization column and trimmed version of the organization from Redundancy_st table
SELECT company, TRIM(Organization)
FROM Redundancy_st
ORDER BY trimmed_organization;

---update the organization column to trim whitespace
UPDATE Redundancy_st
SET Organization = TRIM(Organization);

---select unique values from organization:
SELECT DISTINCT Organization
FROM Redundancy_st
ORDER BY organization;

SELECT * FROM Redundancy_st;

SELECT DISTINCT Field
FROM Redundancy_st
ORDER BY Field;

SELECT DISTINCT Organization
FROM Redundancy_st
WHERE Organization LIKE 'Crypto%'
ORDER BY 1;

UPDATE Redundancy_st
SET Field = 'Crypto'
WHERE Field LIKE 'Crypto%';

 Blank Row

SELECT * FROM Redundancy_st;

SELECT * FROM Redundancy_st
WHERE total_laid_off IS NULL
AND percentage_laid_off IS NULL;

DELETE FROM Redundancy_st
WHERE total_laid_off IS NULL
AND percentage_laid_off IS NULL;

SELECT * 
FROM Redundancy_st
WHERE Field IS NULL;

DELETE FROM Redundancy_st
WHERE Field IS NULL;


 Null value replace using JOIN 

SELECT * 
FROM Redundancy_st
WHERE Organization = 'Airbnb';

SELECT * 
FROM Redundancy_st t1
JOIN Redundancy_st t2
		ON t1.Organization = t2.Organization
        AND t1.Spot = t2.Spot
	WHERE t1.Field IS NULL
    AND t2.Field IS NOT NULL;


INSERT Redundancy_st
SELECT * FROM Redundancy;

Remove Duplicates

WITH dup_cte AS (
    SELECT *, 
           ROW_NUMBER() OVER(PARTITION BY Organization, Spot, Field, total_laid_off, percentage_laid_off, date, stage, country ORDER BY (SELECT NULL)) AS rownum
    FROM Redundancy_st
)
SELECT * 
FROM dup_cte
WHERE rownum > 1;


Standadized Data

SELECT Organization, TRIM(Organization)
FROM Redundancy_st
ORDER BY 1;

UPDATE Redundancy_st
SET Organization = TRIM(Organization);

SELECT DISTINCT Organization
FROM Redundancy_st
ORDER BY 1;

SELECT * FROM Redundancy_st;

SELECT DISTINCT Field
FROM Redundancy_st
ORDER BY 1;

SELECT DISTINCT Field
FROM Redundancy_st
WHERE Field LIKE 'Crypto%'
ORDER BY 1;

UPDATE Redundancy_st
SET Field = 'Crypto'
WHERE Field LIKE 'Crypto%';

Blank Row

SELECT * FROM Redundancy_st;

SELECT * FROM Redundancy_st
WHERE total_laid_off IS NULL
AND percentage_laid_off IS NULL;

DELETE FROM Redundancy_st
WHERE total_laid_off IS NULL
AND percentage_laid_off IS NULL;

SELECT * 
FROM Redundancy_st
WHERE Field IS NULL;

DELETE FROM Redundancy_st
WHERE Field IS NULL;


 Null value replace using JOIN 

SELECT * 
FROM Redundancy_st
WHERE Organization = 'Airbnb';

SELECT * 
FROM Redundancy_st t1
JOIN Redundancy_st t2
		ON t1.Organization = t2.Organization
        AND t1.Spot = t2.spot
	WHERE t1.Field IS NULL
    AND t2.Field IS NOT NULL;


